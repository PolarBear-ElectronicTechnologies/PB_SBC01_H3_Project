 # –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –ø–ª–∞—Ç–∞ PB_MCU01_H503

**PB_MCU01_H503** ‚Äî —ç—Ç–æ –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è –∏ –º–æ—â–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –ø–ª–∞—Ç–∞ –Ω–∞ –±–∞–∑–µ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ **STM32H503CBT6** —Å —è–¥—Ä–æ–º ARM Cortex-M33, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è —Ä–æ—Å—Å–∏–π—Å–∫–æ–π –∫–æ–º–ø–∞–Ω–∏–µ–π **–û–û–û ¬´–ü–æ–ª—è—Ä–Ω—ã–π –ú–µ–¥–≤–µ–¥—å ‚Äì –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏¬ª**.

![](image_mcu/pb_mcu01_h5.png)
---

##  –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä                     | –ó–Ω–∞—á–µ–Ω–∏–µ                             |
|------------------------------|--------------------------------------|
| –ú–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä              | STM32H503CBT6                        |
| –Ø–¥—Ä–æ                         | ARM Cortex-M33                       |
| –ß–∞—Å—Ç–æ—Ç–∞                      | –¥–æ 250 –ú–ì—Ü                           |
| Flash-–ø–∞–º—è—Ç—å                 | 128 –ö–ë                               |
| RAM                          | 32 –ö–ë                                |
| –ü–∏—Ç–∞–Ω–∏–µ                      | 3.3 –í                                |
| –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã                   | USART, SPI, I2C, I3C, FDCAN, USB     |
| –¢–∞–π–º–µ—Ä—ã                      | 16-–±–∏—Ç–Ω—ã–µ —Ç–∞–π–º–µ—Ä—ã –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è  |
| –í—Ö–æ–¥—ã/–≤—ã—Ö–æ–¥—ã                 | –¥–æ 39 GPIO —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ |
| –¢–∞–∫—Ç–æ–≤—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä           | –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π HSI 64 –ú–ì—Ü                |
| –û—Ç–ª–∞–¥–∫–∞                      | –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å SWD                        |
| –§–æ—Ä–º-—Ñ–∞–∫—Ç–æ—Ä                  | –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π DIP-–º–æ–¥—É–ª—å                |
| –†–∞–±–æ—á–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞          | -40...+85 ¬∞C                         |

---

##  –†–∞—Å–ø–∏–Ω–æ–≤–∫–∞

- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –≤—ã–≤–æ–¥–∞–º –ø–æ—Ä—Ç–æ–≤ GPIO: PAx, PBx
- –û—Ç–¥–µ–ª—å–Ω—ã–µ –ø–∏–Ω—ã –¥–ª—è: SWDIO, SWCLK, NRST, VCC, GND
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–∞–∫–µ—Ç–Ω—ã—Ö –ø–ª–∞—Ç (breadboard-friendly)

---

##  –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å

**–û–û–û ¬´–ü–æ–ª—è—Ä–Ω—ã–π –ú–µ–¥–≤–µ–¥—å ‚Äì –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**  
–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç: [https://pb-embedded.ru](https://pb-embedded.ru)

–ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–º –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ–º STM32Cube –∏ –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ STMicroelectronics.

---

##  –û–±–ª–∞—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

PB_MCU01_H503 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:

- –í—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –†–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω—ã—Ö –∏ —Å–µ–Ω—Å–æ—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –ü—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–π –∏ —Å–∏–ª–æ–≤–æ–π —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏
- –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –∏ –æ–±—É—á–µ–Ω–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é STM32

---

##  –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: –ø–æ –∑–∞–ø—Ä–æ—Å—É (—á–µ—Ä–µ–∑ –Ω–∞—â  –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç: https://pb-embedded.ru/, –ª–∏–±–æ –Ω–∞ –Ω–∞—à–µ–º —è–Ω–¥–µ–∫—Å –¥–∏—Å–∫–µ: https://disk.yandex.ru/client/disk/TechnicalSupport )
- –°–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ STM32CubeH5 –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ STM32CubeIDE

# SPS-–º–æ–¥—É–ª—è—Ü–∏—è –Ω–∞ STM32H503 (PB_MCU01_H503)

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é SPS-–º–æ–¥—É–ª—è—Ü–∏–∏ (Single Phase Shift) –Ω–∞ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –ø–ª–∞—Ç–µ **PB_MCU01_H503**, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–µ–π ¬´–ü–æ–ª—è—Ä–Ω—ã–π –ú–µ–¥–≤–µ–¥—å¬ª. –ü–ª–∞—Ç–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –±–∞–∑–µ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ STM32H503 (—è–¥—Ä–æ Cortex-M33), —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–∞–π–º–µ—Ä–∞ TIM1 –≤ —Ä–µ–∂–∏–º–µ complementary PWM —Å dead-time.

---

##  –•–æ–¥ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è STM32CubeMX

- MCU: `STM32H503CBTx`
- –í–∫–ª—é—á–µ–Ω—ã –≤—ã–≤–æ–¥—ã:
  - `TIM1_CH1` ‚Üí `PA8`
  - `TIM1_CH1N` ‚Üí `PB13`
  - `TIM1_CH2` ‚Üí `PA9`
  - `TIM1_CH2N` ‚Üí `PB14`

- –¢–∞–π–º–µ—Ä TIM1:
  - Prescaler = 63 (—á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å 1 –ú–ì—Ü)
  - Counter Mode = Center-aligned
  - Period = 49 (—á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å 20 –∫–ì—Ü)
  - Pulse = 25 (—Å–∫–≤–∞–∂–Ω–æ—Å—Ç—å 50%)
  - DeadTime = 5 (–º–µ—Ä—Ç–≤–æ–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É –ø–ª–µ—á–∞–º–∏)
  - Complementary output –≤–∫–ª—é—á–µ–Ω—ã –¥–ª—è CH1 –∏ CH2

- –í–∫–ª—é—á–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è GPIO –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–∏–Ω–æ–≤

---

### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

1. –û—Ç–∫—Ä—ã—Ç `.ioc` —Ñ–∞–π–ª –≤ STM32CubeMX
2. –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã —Ç–∞–π–º–µ—Ä –∏ –≤—ã–≤–æ–¥—ã
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –≤ STM32CubeIDE
4. –ö–æ–¥ –≤—Ä—É—á–Ω—É—é –¥–æ–ø–æ–ª–Ω–µ–Ω —Ñ—É–Ω–∫—Ü–∏–µ–π —Ñ–∞–∑–æ–≤–æ–≥–æ —Å–¥–≤–∏–≥–∞ `Set_Phase_Shift()`

---

### 3. –ü—Ä–æ—à–∏–≤–∫–∞

1. –ü–ª–∞—Ç–∞ PB_MCU01_H503 –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ —á–µ—Ä–µ–∑ ST-Link v2 –ø–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É SWD
2. –ü–∏—Ç–∞–Ω–∏–µ –ø–æ–¥–∞–Ω–æ —á–µ—Ä–µ–∑ USB –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ –æ—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ—É –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º (–æ–¥–Ω–æ–≤—Ä–µ–º–Ω–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ç–æ—Ä –∏ usb –Ω–µ –ø–æ–¥–∫–ª—á–∞—Ç—å!)
3. –ü—Ä–æ—à–∏–≤–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ STM32CubeIDE (`Run ‚Üí Debug` ‚Üí `Resume`)
–í–æ–∑—å–º–∏—Ç–µ –ø–ª–∞—Ç—É:

![](image_mcu/mcu01h5_stm32.png)

–í–æ–∑—å–º–∏—Ç–µ –∏–º–µ—é—â–∏—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ç–æ—Ä:

![](image_mcu/st-link.png)

–ü–æ–¥—Å–æ–µ–¥–∏–Ω–∏—Ç–µ –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π —Å—Ö–µ–º–µ (–≤—Å–µ –≤—ã–≤–æ–¥—ã –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ç–æ—Ä–µ –∏ –Ω–∞ –ø–ª–∞—Ç–µ):

![](image_mcu/usb_connect.png)
---

## üìÑ –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∞–π–º–µ—Ä–∞ (—Ñ—Ä–∞–≥–º–µ–Ω—Ç –∏–∑ `main.c`)

```c
htim1.Instance = TIM1;
htim1.Init.Prescaler = 63;
htim1.Init.CounterMode = TIM_COUNTERMODE_CENTERALIGNED1;
htim1.Init.Period = 49;
htim1.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
htim1.Init.RepetitionCounter = 0;
htim1.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_ENABLE;
HAL_TIM_PWM_Init(&htim1);

TIM_OC_InitTypeDef sConfigOC = {0};
sConfigOC.OCMode = TIM_OCMODE_PWM1;
sConfigOC.Pulse = 25;
sConfigOC.OCPolarity = TIM_OCPOLARITY_HIGH;
sConfigOC.OCNPolarity = TIM_OCNPOLARITY_HIGH;
HAL_TIM_PWM_ConfigChannel(&htim1, &sConfigOC, TIM_CHANNEL_1);
HAL_TIM_PWM_ConfigChannel(&htim1, &sConfigOC, TIM_CHANNEL_2);

TIM_BreakDeadTimeConfigTypeDef sBreakDeadTimeConfig = {0};
sBreakDeadTimeConfig.DeadTime = 5;
sBreakDeadTimeConfig.AutomaticOutput = TIM_AUTOMATICOUTPUT_ENABLE;
HAL_TIMEx_ConfigBreakDeadTime(&htim1, &sBreakDeadTimeConfig);
```

---

##  –†–µ–∑—É–ª—å—Ç–∞—Ç

–ù–∞ –≤—ã—Ö–æ–¥–∞—Ö `PA8` (CH1) –∏ `PA9` (CH2) –Ω–∞–±–ª—é–¥–∞—é—Ç—Å—è –®–ò–ú-—Å–∏–≥–Ω–∞–ª—ã —Å —á–∞—Å—Ç–æ—Ç–æ–π 20 –∫–ì—Ü –∏ –∑–∞–¥–∞–Ω–Ω—ã–º —Ñ–∞–∑–æ–≤—ã–º —Å–¥–≤–∏–≥–æ–º. Dead-time –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –º–µ–∂–¥—É –∫–æ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã–º–∏ —Å–∏–≥–Ω–∞–ª–∞–º–∏ CH1/CH1N –∏ CH2/CH2N. –§–∞–∑–æ–≤—ã–π —Å–¥–≤–∏–≥ –º–µ–∂–¥—É CH1 –∏ CH2 —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π:

```c
void Set_Phase_Shift(uint16_t shift_us)
{
  if (shift_us > 25) shift_us = 25;
  __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_1, 0);
  __HAL_TIM_SET_COMPARE(&htim1, TIM_CHANNEL_2, shift_us);
}
```

---

##  –û—Å—Ü–∏–ª–ª–æ–≥—Ä–∞–º–º–∞
–ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –æ—Å–∏–ª–ª–æ–≥—Ä–æ—Ñ–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —â—É–ø–∞—Ö, –º—ã –≤—ã–±—Ä–∞–ª–∏ 10—Ö:

![](image_mcu/10x.png)

–ó–∞—Ç–µ–º –ø–æ–¥–∫–ª—é—á–∏—Ç–µ —â—É–ø—ã –∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π–º –≤—ã–≤–æ–¥–∞–º CH1;CH2 –∏ GND: 

![](image_mcu/oscilloscope_connect.png)

–î–∞–ª–µ–µ –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –º–∞—Å—à—Ç–∞–± , –¥–ª—è –Ω–∞—Å —ç—Ç–æ 10–º–∫—Å –∏ 1 V/div –Ω –∞–∫–ª–µ—Ç–∫—É —Å–µ—Ç–∫–∏, –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –¥–ª—è –æ–±–æ–∏—Ö –∫–∞–Ω–∞–ª–æ–≤, –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –ø–æ–¥–ø–∏—Å–∞–Ω–æ –Ω–∞ –æ—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ–µ –∏ –≤–æ –≤–∫–ª–∞–¥–∫–∞—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫, –í—ã –º–æ–∂–µ—Ç–µ –º–µ–Ω—è—Ç—å –º–∞—Å—à—Ç–∞–± –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥—Ä—É–≥ –¥—Ä—É–≥–∞, –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤ –Ω–∞ –æ—Å—Ü–∏–ª–ª–æ–≥—Ä–∞—Ñ–µ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–∞ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ, —ç—Ç–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ:

![](image_mcu/configuration1.png)

![](image_mcu/customisations.png)

–ü–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –í—ã –º–æ–∂–µ—Ç–µ –¥–∞–∂–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–ª—è —Å–µ–±—è –≤ –≤–∏–¥–µ —Ñ–∞–π–ª–∞:

![](image_mcu/result.png)

---

##  –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [PB_MCU01_H503 ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (PDF)](docs/PB_MCU01_H503-UserManual.pdf)
- [ST-Link –¥—Ä–∞–π–≤–µ—Ä—ã](https://www.st.com/en/development-tools/stsw-link009.html)
- [STM32CubeIDE](https://www.st.com/en/development-tools/stm32cubeide.html)
- [STM32CubeMX](https://www.st.com/en/development-tools/stm32cubemx.html)
- [Polar Bear - that's us]( https://pb-embedded.ru/)
  # –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –∏ –∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –Ω–∞—à–µ–π –ø—Ä–æ–¥—É–∫—Ü–∏–µ–π.
  #–¢–∞–∫–∂–µ –º—ã –µ—Å—Ç—å –≤ —Ç–µ–ª–µ–≥–∞–º–º–µ:https://t.me/PBPOLAR
---


